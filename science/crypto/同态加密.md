# 同态加密



# 1 定义

同态加密方法$H$是一种通过对相关密文进行有效操作（不需获知解密密钥），从而允许在加密内容上进行特定代数运算的加密方法。一个同态加密方法$H$由一个四元组组成：
$$
H=\{ KeyGen,Enc,Dec,Eval \}
$$
其中，$KeyGen$表示密钥生成函数。对于非对称同态加密，一个密钥生成元$g$被输入$KeyGen$，并输出一个密钥对$\{pk,sk\}=KeyGen(g)$，其中$pk$表示用于明文加密的公钥（public key），$sk$表示用于解密的密钥（secret key）；对于对称同态加密，只生成一个密钥$sk=KeyGen(g)$。

$Enc$表示加密函数。对于非对称同态加密，一个加密函数以公钥$pk$和明文$m$作为输入，生成密文$c=Enc_{pk}(m)$作为输出；对于对称同态加密，加密过程会使用公共密钥$sk$和明文$m$作为输入，并生成密文$c=Enc_{sk}(m)$。

$Dec$表示解密函数。对于非对称同态加密和对称同态加密，隐私密钥$sk$和密文$c$被用来作为生成相关明文$m=Dec_{sk}(c)$的输入。

$Eval$表示评估函数。评估函数$Eval$将密文$c$和公共密钥$pk$（对于非对称同态加密）作为输入，并输出与明文对应的密文。

设$Enc_{pk}(\cdot)$表示使用$pk$作为加密密钥的加密函数。设$\mathcal{M}$表示明文空间，且$\mathcal{C}$表示密文空间。一个安全密码系统若满足以下条件，则可被称为同态的（homomorphic）：
$$
\forall m_{1}, m_{2} \in \mathcal{M}, \quad \operatorname{Enc}_{\mathrm{pk}}\left(m_{1} \odot_{\mathcal{M}} m_{2}\right) \leftarrow \operatorname{Enc}_{\mathrm{pk}}\left(m_{1}\right) \odot_{\mathcal{C}} \operatorname{Enc}_{\mathrm{pk}}\left(m_{2}\right)
$$

其中，$\leftarrow$表示左边项等于或可以直接由右边项计算出来，而无需任何中间解密。

令$[[\cdot]]$为同态加密运算符，并对密文的加法操作和乘法操作按如下方式重载：

- 加法：$Dec_{sk}([[u]] \odot_{\mathcal{C}} [[v]] )= Dec_{sk}([[u+v]])$。
- 标量乘法：$Dec_{sk}([[u]] \odot_{\mathcal{C}} n )= Dec_{sk}([[u \cdot n]])$。

# 2 分类

同态加密分为三类：

- 部分同态加密（Partially Homomorphic Encryption，PHE）
- 些许同态加密（Somewhat Homomorphic Encryption，SHE）
- 全同态加密（Fully Homomorphic Encryption，FHE）

通常来讲，对于同态加密方法，计算的复杂度是随功能性一同增长的。

## 2.1 部分同态加密（PHE）

对于部分同态加密方法，$(\mathcal{M}, \odot_{\mathcal{M}})$和$(\mathcal{C}, \odot_{\mathcal{C}})$都是群，操作符$\odot_{\mathcal{C}}$能够无限次地用于密文。PHE是一种群同态（group homomorphism）技术。特别地，若$\odot_{\mathcal{M}}$是加法运算符，则该方案可被称为加法同态的（additively homomorphic）；若$\odot_{\mathcal{M}}$是乘法运算符，则该方案被称为乘法同态的（multiplicative homomorphic）。

## 2.2 些许同态加密（SHE）

些许同态加密指一同态加密方法中的一些运算操作（如加法和乘法）只能执行有限次。一些文献中也定义SHE为只有有限数量的某些电路（如跳转程序、混淆电路）能够支持进行任意次数的运算。每一次在密文上的操作会增加密文上的噪声音量，而乘法操作是增加噪声量的主要技术手段。当噪声量超过一个上限值后，解密操作就不能得出正确结果了。这就是为什么绝大多数SHE方法会要求限制计算操作的次数。

## 2.3 全同态加密（FHE）

全同态加密方法允许对密文进行无限次数的加法、乘法运算操作。（实现任意的函数计算，加法（additive）和乘法（multiplicative）操作时唯二所需要的操作）

FHE分为四种：

- Ideal Lattice-based FHE
- Approximate-GCD based FHE
- (R)LWE-based FHE
- NTRU-like FHE

目前的FHE建立在SHE的基础之上，并通过实现代价高昂的自助法（bootstrap）操作实现。Bootstrap操作通过执行解密、密文上的加密操作和对密钥加密来对密文进行重加密，以减少密文在后续计算中的噪声量。由于自助法的代价高昂，FHE方案在实践中往往不优于传统的安全多方计算方法。因此，许多研究人员目前正着眼于发现满足特定需求的、更有效的SHE方法，而非发掘FHE方法。此外，FHE还需假设循环安全性（或称KDM安全性），即通过使用公共密钥来加密隐私密钥，从而使隐私密钥变得安全。然而，没有FHE能够被证明在任何功能下都是安全的，并且FHE具有针对不可区分的选择密文攻击（IND-CCA1）的安全性。



> 参考资料：
>
> 1. 《联邦学习》杨强.et al